# üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è JWT —Ç–æ–∫–µ–Ω—ñ–≤

## –û–≥–ª—è–¥ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è JWT —Ç–æ–∫–µ–Ω—ñ–≤ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω—É —Ä–æ–±–æ—Ç—É –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –ø–æ–≤—Ç–æ—Ä–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ application.properties:
```properties
# JWT —Ç–æ–∫–µ–Ω –∂–∏–≤–µ  –≥–æ–¥–∏–Ω—É
app.jwt.expiration=1200000 **20 —Ö–≤–∏–ª–∏–Ω**

# –°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è –ø—ñ–¥–ø–∏—Å—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤
app.jwt.secret=VoiceMoodSecretKeyForJWTTokenGenerationAndValidation2024SuperSecureDefaultKey
```

## üîß –õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
- **–Ü–Ω—Ç–µ—Ä–≤–∞–ª:** –ö–æ–∂–Ω—ñ 2 —Ö–≤–∏–ª–∏–Ω–∏
- **–£–º–æ–≤–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** –ö–æ–ª–∏ –¥–æ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –º–µ–Ω—à–µ 15 —Ö–≤–∏–ª–∏–Ω
- **–¢–∏–ø–∏ —Ç–æ–∫–µ–Ω—ñ–≤:** –¢—ñ–ª—å–∫–∏ JWT —Ç–æ–∫–µ–Ω–∏ (–≥–æ—Å—Ç—å–æ–≤—ñ —Ç–æ–∫–µ–Ω–∏ –Ω–µ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è)

### 2. –ü—Ä–æ—Ü–µ—Å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
1. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —á–∞—Å –∂–∏—Ç—Ç—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
2. –Ø–∫—â–æ –∑–∞–ª–∏—à–∏–ª–æ—Å—å –º–µ–Ω—à–µ 15 —Ö–≤–∏–ª–∏–Ω - –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
3. –°–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä—É—î –Ω–æ–≤–∏–π —Ç–æ–∫–µ–Ω –∑ —Ç—ñ—î—é –∂ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
4. –ö–ª—ñ—î–Ω—Ç –æ–Ω–æ–≤–ª—é—î –ª–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ —Ç–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### 3. –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: "üîÑ –°–µ—Å—ñ—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–æ"
- –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—å –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é

## üì° API Endpoints

### POST /api/auth/refresh-token
**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```
Authorization: <JWT_TOKEN>
Content-Type: application/json
```

**–£—Å–ø—ñ—à–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "success": true,
  "message": "–¢–æ–∫–µ–Ω —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ",
  "token": "–Ω–æ–≤–∏–π_jwt_—Ç–æ–∫–µ–Ω",
  "user": {
    "id": 1,
    "username": "testuser",
    "role": "USER",
    "balance": 5000.0,
    "discount": 15.5
  }
}
```

**–ü–æ–º–∏–ª–∫–∞:**
```json
{
  "success": false,
  "message": "–¢–æ–∫–µ–Ω –∑–∞–Ω–∞–¥—Ç–æ —Å—Ç–∞—Ä–∏–π –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"
}
```

## üíª JavaScript —Ñ—É–Ω–∫—Ü—ñ—ó

### –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:
- `getTokenExpiryTime(token)` - –æ—Ç—Ä–∏–º—É—î —á–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞
- `refreshTokenIfNeeded()` - –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–∞ –æ–Ω–æ–≤–ª—é—î —Ç–æ–∫–µ–Ω –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ
- `makeAuthenticatedRequest()` - –≤–∏–∫–æ–Ω—É—î API –∑–∞–ø–∏—Ç–∏ –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º

### –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø–∏—Ç –∑ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º —Ç–æ–∫–µ–Ω–∞
const response = await makeAuthenticatedRequest('/api/products', {
    method: 'GET',
    headers: { 'Content-Type': 'application/json' }
});
```

## üîí –ë–µ–∑–ø–µ–∫–∞

### –û–±–º–µ–∂–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
- –¢–æ–∫–µ–Ω –º–æ–∂–Ω–∞ –æ–Ω–æ–≤–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤—ñ–Ω —â–µ –Ω–µ –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–∏–π
- –ì–æ—Å—Ç—å–æ–≤—ñ —Ç–æ–∫–µ–Ω–∏ –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- –î–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –Ω–µ –º–æ–∂—É—Ç—å –æ–Ω–æ–≤–∏—Ç–∏ —Ç–æ–∫–µ–Ω

### –ó–∞—Ö–∏—Å–Ω—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏:
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å—Ç–∞—Ç—É—Å—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∞–∫–∞—É–Ω—Ç—É
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –∑ –æ–Ω–æ–≤–ª–µ–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏

## üìã –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –¢–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª: `test_jwt.html`
–î–æ—Å—Ç—É–ø–Ω—ñ —Ç–µ—Å—Ç–∏:
1. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è** - –≤—Ö—ñ–¥ —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á/–≥—ñ—Å—Ç—å
2. **–í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω–∞** - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏–Ω–Ω–æ—Å—Ç—ñ
3. **–†—É—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è** - –ø—Ä–∏–º—É—Å–æ–≤–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è** - —Ç–µ—Å—Ç –ª–æ–≥—ñ–∫–∏ –∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è
5. **–ê–Ω–∞–ª—ñ–∑ —á–∞—Å—É –∂–∏—Ç—Ç—è** - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó

### –°—Ü–µ–Ω–∞—Ä—ñ—ó —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```javascript
// 1. –£–≤—ñ–π—Ç–∏ —è–∫ testuser
// 2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∞—Å –∂–∏—Ç—Ç—è —Ç–æ–∫–µ–Ω–∞
// 3. –î–æ—á–µ–∫–∞—Ç–∏—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (—è–∫—â–æ –∑–∞–ª–∏—à–∏–ª–æ—Å—å < 15 —Ö–≤)
// 4. –ê–±–æ —Ä—É—á–Ω–æ –æ–Ω–æ–≤–∏—Ç–∏ —Ç–æ–∫–µ–Ω
```

## üéØ –ü–µ—Ä–µ–≤–∞–≥–∏ —Å–∏—Å—Ç–µ–º–∏

### –î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
- ‚úÖ –ë–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–∞ —Ä–æ–±–æ—Ç–∞ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–µ—Å—ñ–π
- ‚úÖ –ü—Ä–æ–∑–æ—Ä–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ

### –î–ª—è –±–µ–∑–ø–µ–∫–∏:
- üîí –ö–æ—Ä–æ—Ç–∫–∏–π —á–∞—Å –∂–∏—Ç—Ç—è —Ç–æ–∫–µ–Ω—ñ–≤ (1 –≥–æ–¥–∏–Ω–∞)
- üîí –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–µ—Å—ñ–π
- üîí –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ

### –î–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤:
- üìä –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –æ–Ω–æ–≤–ª–µ–Ω—å —Ç–æ–∫–µ–Ω—ñ–≤
- üìä –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–µ—Å—ñ–π
- üìä –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —á–∞—Å–æ–º –∂–∏—Ç—Ç—è —Ç–æ–∫–µ–Ω—ñ–≤

## üö® –í–∞–∂–ª–∏–≤—ñ –Ω–æ—Ç–∞—Ç–∫–∏

1. **–ì–æ—Å—Ç—å–æ–≤—ñ –∞–∫–∞—É–Ω—Ç–∏** –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
2. **–ù–µ–∞–∫—Ç–∏–≤–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** –Ω–µ –º–æ–∂—É—Ç—å –æ–Ω–æ–≤–∏—Ç–∏ —Ç–æ–∫–µ–Ω
3. **–ü—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω—ñ —Ç–æ–∫–µ–Ω–∏** –Ω–µ–º–æ–∂–ª–∏–≤–æ –æ–Ω–æ–≤–∏—Ç–∏
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è** –ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–∏—Ö —Å–µ—Å—ñ–π

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â

### –†–æ–∑—Ä–æ–±–∫–∞ (–º–µ–Ω—à–µ –±–µ–∑–ø–µ–∫–∏, –±—ñ–ª—å—à–µ –∑—Ä—É—á–Ω–æ—Å—Ç—ñ):
```properties
app.jwt.expiration=7200000  # 2 –≥–æ–¥–∏–Ω–∏
```

### –ü—Ä–æ–¥–∞–∫—à–Ω (–±—ñ–ª—å—à–µ –±–µ–∑–ø–µ–∫–∏):
```properties
app.jwt.expiration=1800000  # 30 —Ö–≤–∏–ª–∏–Ω
```

### –î–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤:
```properties
app.jwt.expiration=86400000  # 24 –≥–æ–¥–∏–Ω–∏ (–∑ refresh token)
``` 